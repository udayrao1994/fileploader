const express = require('express');
const cors = require('cors');  // Import CORS
const generateReports = require('./reportService');
const path = require('path');

const app = express();

// Enable CORS for all origins (or restrict to specific origins if needed)
app.use(cors());

app.get('/generate-reports', async (req, res) => {
    try {
        await generateReports(); // Generate reports (e.g., PDF, Excel)
        res.send('Reports generated successfully!');
    } catch (err) {
        res.status(500).send('Error generating reports: ' + err.message);
    }
});

app.get('/download/pdf', (req, res) => {
    res.download(path.join(__dirname, 'reports/report.pdf'));  // Download the PDF
});

app.get('/download/excel', (req, res) => {
    res.download(path.join(__dirname, 'reports/report.xlsx'));  // Download the Excel file
});

app.listen(4000, () => console.log('Server running on http://localhost:4000'));
